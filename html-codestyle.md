# Руководство по оформлению HTML/CSS кода

Это руководство описывает правила оформления и форматирования HTML и CSS кода.
Его цель — повысить качество кода и облегчить совместную работу и поддержку инфраструктуры.

## Общие правила оформления кода

### Отступы
Для создания отступов всегда используйте символ табуляции. Не используйте пробелы и не смешивайте табуляцию с пробелами.
Настройте редактор кода так, чтобы он отображал невидимые символы.
Это позволит избегать случайных пробелов в конце строк или в пустых строках и легче отслеживать изменения в коде.
В PHPStorm это делается в меню _View_ -> _Active Editor_ -> _Show Whitespaces_ и в настройках
_Preferences_ -> _Editor_ -> _General_ -> _Appearence_ -> _Show Whitespaces_.

### Кодировка
Несмотря на то, что UTF-8 захватил весь мир, клиенты могут устанавить наш продукт либо в ANSI-кодировке, либо в UTF-8.
Исходной кодировкой репозитария является `windows-1251`. В этой кодировке должны создаваться и
редактироваться все текстовые файлы. Обязательно в настройках проекта PHPStorm (_Editor_ -> _File Encodings_)
укажите `windows-1251`.

### Перевод строки
Стандартом для разрыва строки является символ `\n`.
Настройка PHPStorm: _Editor_ -> _Code Style_ -> _Line separator_ -> _Unix and OS X \n_.

### Регистр
Названия тегов, атрибутов и названия классов должны быть всегда в нижнем регистре.

### Пробелы в конце строки
Убирайте пробелы в конце строки. Пробелы в конце строк не обязательны и усложняют использование diff.
В PHPStorm есть настройка _Strip Trailing Spaces on Save_, которая удаляет пробелы в конце строк перед сохранением файла.

### Комментарии
Все комментарии должны быть на английском языке.

## Правила оформления HTML

### Семантика

Семантика - это когда смотришь на html-код страницы и понимаешь логическое и функциональное назначение каждого тега.
В HTML существует довольно много тегов, которые в своем названии несут четкую семантику: `<a>`, `<p>`, `<i>`, `<menu>`.
Не стоит с помощью CSS таким тегам менять их базовый смысл.
Идеально для верстальщика было бы удобно использовать теги с произвольными названиями.

```html
<users>
	<user>
		<avatar></avatar>
		<name></name>
	</user>
</users>
```

`HTML5` предлагает механизм для создания произвольных тегов (Web Components), но, к сожалению,
его реализация не самая простая (нужно писать JavaScript) и поддержка в браузерах неполная.
Единственный нормальный способ писать семантический код — использовать атрибут `class`.
Он позволяет описать смысл тега естественными словами, не требователен к уникальности (в отличие от атрибута `id`) и
поддерживает возможность указать несколько классов к одном тегу.

### Основы верстки

- Используем теги `div` (для блочных элементов) и `span` (для строчных и строчно-блочных элементов).
- Остальные теги используем только согласно их базовому смыслу.
- `<b>`, `<i>`, `<s>`, `<p>`, `h1-h6` - используются только для форматирования текста.
  Как правило, эти стили находятся в шаблоне сайта и в стилях компонентов не присутствуют.
- Для привязки CSS-свойств к тегу используем только атрибут `class`.
- Если нажатие на элемент приводит к открытию новой страницы, используем тег `<a>`.
  В противном случае используем `<span>` или `<div>`.
- Отступы между логическими блоками никогда не делаем пробелами или тегом `<br>`.
- Структуру html-тегов необходимо делать по сетке дизайна. "Колонки" и логические блоки одного уровня
  обязательно помещать в контейнер.
- Удаление логических блоков не должно рушить дизайн.
- Всегда есть вероятность, что на реальном сайте количество текста будет больше, чем нарисовано в макете.
  Верстка должна быть адаптивной к появлению дополнительных строк и к длинным строкам без пробелов.
- Текстовый элемент не может быть на одном уровне с тегом.

  Плохо:
  ```html
  <div class="task-detail-group">Задача в проекте: <div class="task-detail-link">добавить</div></div>
  ```
  Хорошо:
  ```html
  <div class="task-detail-group">
     <span class="task-detail-group-label">Группа:</span>
     <span class="task-detail-group-name">Название группы</span>
  </div>
  ```

### Особые случаи
- Внимательно относимся к элементам `inline-block`, перевод строки между ними будет отображен как пробел.
  Чтобы не писать теги в одну длинную строку, можно воспользоваться следующим приемом:
  ```php
  <div class="inline-block-items"><?
      ?><span class="inline-block-item">Inline Item 1</span><?
      ?><span class="inline-block-item">Inline Item 2</span><?
      ?><span class="inline-block-item">Inline Item 3</span><?
      ?><span class="inline-block-item">Inline Item 4</span><?
  ?></div>
  ```
  Визуально теги разбиты и отделены отступами, а в результирующем HTML-коде будет одна строка.

- Элементы с обтеканием (float)
  - Неприятной особенностью свойства float является то, что такой блок может "вывалиться" из блока-родителя.
    Это происходит из-за того, что float-элемент удаляется из потока и родитель не выделяет место под него.
    Решить эту проблему можно несколькими способами:
    - Поставить родителю `overflow: hidden/auto`.
    - Поставить родителю `float`.
    - Добавить в родителя элемент с `clear`. Чтобы не добавлять в HTML-код лишний элемент, можно задать его через `:after`.
  - Элементы с обтеканием обязательно должны находится в контейнерах, чтобы не влиять на соседние логические блоки.

- Для повторяющихся элементов в строчку (пункты меню, список фотографий) отдавайте приоритет `inline-block`
  вместо `float`.


### Тип документа
Создавайте новую верстку по стандарту `HTML5`. В старых шаблонах по возможности избавляйтесь
от `XHTML` (слешей в конце тегов `<br />`, `<img />`).
```html
<!DOCTYPE html>
```

### Альтернативные атрибуты (alt, title)
Очень часто разработчики забывают указывать альтернативные подписи к иконками, кнопками или другим графическим элементам.
Наличие атрибутов `title` и `alt` в верстке поможет решить эту проблему.


### Разделение ответсвенности
Держите структуру (разметка), оформление (стили) и поведение (скрипты) раздельно и постарайтесь свести
взаимодействие между ними к минимуму. Убедитесь, что документы и шаблоны содержат только HTML, и что HTML служит только для задания структуры документа.
Весь код, отвечающий за оформление, перенесите в файлы стилей, а код отвечающий за поведение — в скрипты.
Отделение структуры от представления и поведения помогает облегчить поддержку кода.
Изменение шаблонов и HTML-документов всегда занимает больше времени чем изменение файлов стилей или скриптов.

### Формы
- В верстке всегда должен присутствовать тег `<form>`.
- Подписи полей должны быть слинкованы к соответствующим элементам формы.
- Должно быть показано, как выводится ошибка и/или сообщение об успешном выполнении операции.
- Переключение между элементами формы по клаваше `Tab`.
- Интерактивность: смена фокуса должна вызуально подсказывать пользователю активный элемент.

### Картинки
- Используйте SVG вместо растровых изображений.
- В случае, если SVG использовать затруднительно, используйте формат PNG.
- Объединяйте картинки в спрайты. Это ускорит отображение страницы.

## Правила форматирования HTML

### Новая строка для каждого блочного или табличного элементов
Выделяйте новую строку для каждого блочного, табличного или списочного элемента и ставьте отступы
для каждого дочернего элемента.

Плохо:
```html
<div class="menu">
<div class="menu-item"><span class="menu-item-title">Home</span></div><div class="menu-item"><span class="menu-item-title">Search</span></div>
</div><div class="breadcrumb"></div>
```

Хорошо:
```html
<div class="menu">
	<div class="menu-item">
		<span class="menu-item-title">Home</span>
	</div>
	<div class="menu-item">
		<span class="menu-item-title">Search</span>
	</div>
</div>
<div class="breadcrumb"></div>
```

### Двойные кавычки в атрибутах
Значения HTML-атрибутов всегда в двойных кавычках.

## Правила оформления CSS

## Каскадные селекторы
Любой блок на странице должен описываться селектором класса.
Не используйте каскадные селекторы т.к. они нарушают принцип независимости компонентов.
Это же правило относится к селекторам прямого потомка (`>`) и соседнего элемента (`+`).

- Исключения
  - Селекторы состояний (selected, active, hover).
  - Селекторы контекста. Существуют случаи, когда компонент используется на разных страницах или в разном окружении.
    В этом случае удобно использовать селекторы контекста. Важно, чтобы эти контекстные стили содержались
    в родительском компоненте.
  - Верстка, в которой нельзя изменить структуру HTML-тегов.

## Именование классов

- Имена классов записываются на английском языке в нижнем регистре.
- Если не уверены в написании английского слова, проверьте его по словарю. PHPStorm имеет встроенную проверку орфографии.
- Желательно, чтобы терминология в названии класса совпадала с названиями, которыми оперирует разработчик
  (названия полей в базе данных, названия PHP-классов).
- Для разделения слов в именах используется дефис (-).
- Создавайте имена CSS-селекторов максимально информативными и понятными.
  Это поможет упростить разработку и отладку кода. Не стесняйтесь использовать длинные названия классов.
- Первым словом в названии класса должно идти название модуля, а затем уже описание сущности.
  Такой формат, с одной стороны, сразу показывает принадлежность стилей, с другой — гарантирует их уникальность.
  Уникальность стилей обеспечивает независимость верстки компонентов.
- Вложенные элементы должны сохранять контекст именования своего родителя.
- Допускается использование сокращений.
- Старый префикс `bx-` не должен использоваться.
- Если к элементы происходит обращение по классу через JavaScript, то такой класс должен иметь префикс `js-`.
- Для верстки шаблона сайта допускается опускать префикс модуля.

## Inline-стили
Избегайте инлайновых стилей, все стили должны задаваться в CSS-файле через назначение классов элементам.
Инлайновые стили применимы, только если они являются неотъемлемой часть контента страницы
(аватар пользователя, размер ползунков в фильтре и т. п.).

## Селекторы типа
Избегайте использование имен классов с селектором тега.

Плохо:
```css
div.task-detail-title {
	margin: 20px;
}
```
Хорошо:
```css
.task-detail-title {
	margin: 20px;
}
```

## Сокращенная форма записи свойств
CSS предлагает множество различных сокращенных форм записи (например, font, background, margin, padding),
которые рекомендуется использовать везде где это возможно, даже если задается только одно из значений.
Использование сокращенной записи свойств полезно для большей эффективности и лучшего понимания кода.

## 0 и единицы измерения
Не указывайте единицы измерения для нулевых значений.

## Кавычки в ссылках
Не используйте кавычки с функцией `url()`, кроме случая, когда ссылка содержит пробел.

## Хаки
Избегайте хаков в CSS-коде. Если все таки требуется сделать уникальные свойства для конкретного браузера, воспользуйтесь
специальными классами `.bx-chrome`, `.bx-firefox`, `.bx-ie10`.

## Группировка правил
Старайтесь, чтобы селекторы, описывающие определенный блок верстки, находились в одном месте и не были раскиданы
по CSS-файлу.

## Селекторы состояний (selected, active и hover)

## Псевдоселекторы (:before, :after)
Позволяют не нагромождать HTML-код лишними элементами, имеющими _декоративное назначение_. Важно понимать, что этих
элементов нет в DOM и обратиться к ним через JavaScript невозможно.

## Сброс стилей (CSS Reset)
Не используем CSS Reset в верстке. Компоненты являются независимыми блоками. На них не должны влиять CSS-правила,
созданные для всей страницы. Это нарушает независимость блоков и затрудняет их повторное использование.
Общий сброс стилей реализуется с помощью глобальных CSS-правил, которые в большинстве случаев
пишутся к селекторам на тег, что нежелательно использовать в нашей верстке. Кроме того, сброс стилей влияет
на производительность рендеринга страницы и может конфликтовать с версткой клиентов.

## Правила форматирования CSS

- При создании правила для нескольких селекторов помещайте каждый селектор на отдельной строке.
- Перед открывающей скобкой ставьте один пробел.
- Внутри блока объявлений помещайте каждое объявление на отдельной строке.
- Добавляйте один уровень отступов перед каждым объявлением.
- Ставьте пробел после двоеточия внутри объявления.
- Всегда ставьте точку с запятой после последнего объявления в блоке.
- Ставьте закрывающую скобку на одной вертикальной линии с первым символом в селекторе.
- Ставьте пробел после каждой запятой в объявлениях со множественным значением
- Разделяйте правила пустой строкой.
- Сортировка свойств: от общего — к локальному и менее важному
  ```css
  .crm-lead-form {
      margin: 34px;
      color: #000;
   }

  .crm-lead-title,
  .crm-invoice-title,
  .crm-company-title {
      position: relative;
      display: block;
      width: 15px;
      height: 15px;
      margin: 12px 0 17px;
      padding: 10px;
      border: 1px solid red;
      color: #fff;
      background: #000;
  }
  ```

- Исключения
  - К большим группам правил, состоящих из одного свойства, может применяться запись в одну строку.
    В таком случае следует ставить пробел после открывающей и перед закрывающей скобками.

    ```css
    .crm-column-title { width: 10%; }
    .crm-column-author { width: 20%; }
    .crm-column-actions { width: 30%; }
    ```

  - Длинные значения свойств, разделяемые запятыми — как, например, набор градиентов или теней — могут
    быть помещены на отдельной строке каждое, чтобы повысить читабельность кода и сообщений в системе управления версиями.
    Формат записи может слегка различаться, один из вариантов приведён ниже.
    ```css
    .disk-info-popup {
        box-shadow:
            1px 1px 1px #000,
            2px 2px 1px 1px #ccc inset;
        background-image:
            linear-gradient(#fff, #ccc),
            linear-gradient(#f3c, #4ec);
    }
    ```


## Тестирование верстки (чеклист)

- Проверка соответствия макету
- Браузеры
  - Chrome
  - Firefox
  - IE11
  - IE Edge
  - Safari

- Минимальное и максимальное разрешение экрана
- Переполнение блоков
  - Длинный текст без пробелов
  - Длинный текст с пробелами
- Удаление необязательных блоков, которые могут отсутсвовать
- Retina-экран


## Особенности интеграции с Битрикс

### Шаблоны и компоненты


### Контексты продуктов и шаблонов сайтов
- Корпоративный портал
	- Шаблон Light
	- Шаблон Bitrix24
- Управление сайтом
- Решение Интернет-магазин
- Шаблоны партнеров
- Индивидуальные сайты
- Использование библиотек
- Верстка шаблона сайта

## Приемы верстки

В этом разделе собраны типовые подходы к решению частых задач верстки.

## Верстка для мобильных устройств